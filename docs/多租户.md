多租户机制是建立在用户鉴权的基础上, 实现的用户资源隔离。

在处理完用户鉴权之后, 需要处理的是在多用户情境下读写冲突的问题。这个问题主要集中在
同步执行的逻辑性, 异步执行可以通过维护一个队列, 来保证任务执行的有序性。


但是一旦存在有同步任务, 那么久必须等待同步任务处理完成才可以开始执行下一个任务。
主要包括下述情景。这里A任务先于B任务执行。

1. A是同步任务, B是同步任务
阻塞到A任务执行完成然后去通知B任务执行

2. A是同步任务, B是异步任务
等待同步任务执行完毕, 再将B任务置于任务队列中

3. A是异步任务, B是同步任务, 且AB任务不存在数据依赖关系
直接按照正常流程执行

4. A是异步任务, B是同步任务, AB存在有数据依赖关系
B任务必须等待A任务执行完毕才可以开始执行


#### 数据依赖关系的获取
可以通过该在代码生成阶段, 解析出数据来源信息, 这里我们考虑到数据库的差异性,
有的数据库支持行级锁, 间隙锁, 分段锁的方式用于提升并发度。这里我们采用悲观控制
策略, 统一使用表锁(对于不同类型的数据库,"表"的含义不同)。来控制数据依赖关系。

